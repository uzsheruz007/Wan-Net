{% extends 'ctf/ctf_home.html' %}

{% block title %}{{ challenge.title }}{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <a href="{% url 'challenges' %}"
        style="color: var(--text-muted); text-decoration: none; display: inline-block; margin-bottom: 20px;">
        <i class="fas fa-arrow-left"></i> Masalalarga qaytish
    </a>

    <div class="challenge-card" style="padding: 40px;">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px;">
            <div>
                <h1 style="margin: 0; color: var(--primary); font-size: 2rem;">{{ challenge.title }}</h1>
                <span class="challenge-category" style="margin-top: 10px;">{{ challenge.get_category_display }}</span>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 2rem; color: var(--secondary); font-weight: bold;">{{ challenge.points }}</div>
                <div style="color: var(--text-muted);">BALL</div>
            </div>
        </div>

        <div style="margin-bottom: 40px; line-height: 1.8; color: #d1d5db; font-size: 1.1rem;">
            {{ challenge.description|linebreaks }}
        </div>

        {% if challenge.file %}
        <div style="margin-bottom: 30px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
            <i class="fas fa-file-download" style="color: var(--primary); margin-right: 10px;"></i>
            <a href="{{ challenge.file.url }}" download style="color: #fff; text-decoration: none;">Faylni yuklab
                olish</a>
        </div>
        {% endif %}

        {% if challenge.html_content %}
        <div
            style="margin-bottom: 30px; background: rgba(0, 242, 255, 0.1); padding: 15px; border-radius: 8px; border: 1px solid var(--primary);">
            <i class="fas fa-globe" style="color: var(--primary); margin-right: 10px;"></i>
            <span style="color: #fff; margin-right: 20px;">Ushbu masala uchun maxsus veb-sayt mavjud:</span>
            <a href="{% url 'challenge_render' challenge.id %}" target="_blank" class="btn-ctf"
                style="font-size: 0.9rem; padding: 5px 15px;">
                Saytga O'tish <i class="fas fa-external-link-alt"></i>
            </a>
        </div>
        {% endif %}

        <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 30px;">
            {% if is_solved %}
            <div
                style="text-align: center; padding: 30px; background: rgba(0, 255, 157, 0.1); border: 1px solid var(--success); border-radius: 10px;">
                <i class="fas fa-flag-checkered"
                    style="font-size: 3rem; color: var(--success); margin-bottom: 15px;"></i>
                <h2 class="solved-badge">FLAG TOPILDI!</h2>
                <p>Siz bu masalani yechib bo'lgansiz.</p>
            </div>
            {% else %}
            <form method="post">
                {% csrf_token %}
                <label style="display: block; margin-bottom: 10px; color: var(--text-muted);">Flag:</label>
                <input type="text" name="flag" class="flag-input" placeholder="FLAG{...}" required autocomplete="off">
                <button type="submit" class="btn-ctf" style="width: 100%;">
                    <i class="fas fa-paper-plane"></i> Yuborish
                </button>
            </form>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}